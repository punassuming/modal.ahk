; Modal.ahk Configuration File
; AutoHotkey v1.x
;
; This file contains global settings and per-application keybindings
; for modal vim-like navigation in Windows 10/11 applications.
;
; ============================================================================
; CONFIGURATION GUIDE
; ============================================================================
;
; GLOBAL SETTINGS:
; - ToggleKey: Key to toggle modal mode (default: CapsLock)
; - ActivationMethod: "toggle" or "hold" - how the modal mode is activated
; - ShowNotifications: true/false - show mode change notifications
; - NotificationTimeout: milliseconds to show notifications
;
; APPLICATION SECTIONS:
; Each application section starts with [App_<AppName>]
; Required keys:
; - Enabled: true/false - whether this app config is active
; - WindowClass: AHK window class to match (use Window Spy)
; - WindowTitle: Optional window title pattern (regex)
; - ControlPattern: Optional control pattern to match for context
;
; KEYBINDING FORMAT:
; <action>=<key_sequence>
; 
; Available actions:
; - nav_up, nav_down, nav_left, nav_right: Basic navigation
; - nav_word_left, nav_word_right: Word navigation
; - nav_line_start, nav_line_end: Line navigation
; - nav_page_up, nav_page_down: Page navigation
; - nav_doc_start, nav_doc_end: Document navigation
; - nav_history_back, nav_history_forward: History navigation
; - select_up, select_down, select_left, select_right: Selection
; - action_delete, action_yank, action_paste: Editing
; - action_undo, action_redo: Undo/Redo
; - action_search, action_search_next: Searching
; - view_toggle, view_refresh: View actions
; - tab_next, tab_prev, tab_close, tab_new: Tab management
; - bookmark_add, bookmark_goto: Bookmarks
; - custom_<name>=<keys>: Custom per-app actions
;
; Key notation follows AHK syntax:
; ^ = Ctrl, ! = Alt, + = Shift, # = Win
; {Up}, {Down}, {Left}, {Right}, {Enter}, {Escape}, etc.
;
; ============================================================================

[Global]
ToggleKey=CapsLock
ActivationMethod=toggle
ShowNotifications=true
NotificationTimeout=600
IconNormal=icons\normal.ico
IconInsert=icons\insert.ico
DefaultMode=normal

; Enable repeat count (e.g., 5j moves down 5 lines)
EnableRepeatCount=true
MaxRepeatCount=500

; ============================================================================
; DEFAULT KEYBINDINGS
; These apply when no application-specific binding is defined
; ============================================================================

[Default]
; Basic Navigation (vim hjkl)
nav_left=h
nav_down=j
nav_up=k
nav_right=l

; Word Navigation
nav_word_left=b
nav_word_right=w

; Line Navigation
nav_line_start=0
nav_line_end=$

; Page Navigation
nav_page_up=Ctrl+u
nav_page_down=Ctrl+d

; Document Navigation
nav_doc_start=gg
nav_doc_end=G

; Actions
action_delete=d
action_yank=y
action_paste=p
action_undo=u
action_redo=Ctrl+r

; Searching
action_search=/
action_search_next=n
action_search_prev=N

; Mode
mode_insert=i
mode_append=a
mode_visual=v

; ============================================================================
; XPLORER2 FILE MANAGER
; ============================================================================

[App_Xplorer2]
Enabled=true
WindowClass=ATL:ExplorerFrame
ControlPattern=ATL:BrowserListView

; Navigation
nav_left={Backspace}
nav_down={Down}
nav_up={Up}
nav_right={Enter}

; Extended Navigation
nav_page_up={PgUp}
nav_page_down={PgDn}
nav_doc_start={Home}
nav_doc_end={End}

; History
nav_history_back=!{Left}
nav_history_forward=!{Right}

; Tabs
tab_next=^!{Right}
tab_prev=^!{Left}
tab_close=^{F4}
tab_new=^{Insert}

; Tree navigation
tree_focus_key=gf
tree_left={Left}
tree_right={Right}

; Bookmarks
bookmark_goto=!bm
bookmark_add=!ba

; View Options
view_hidden=^!+h
view_dir_size=^d
view_filter=^h
view_filter_toggle=^j
view_recents=!{F2}

; Ordering
order_by_size=^!s
order_by_time=^!t
order_by_name=^!n
order_by_date=^!d

; Quick actions
action_search=^!+f
action_preview=^q
action_edit={F4}
action_select_all=!s
action_select_toggle={NumpadMult}
action_console={F10}
action_user_menu=!uum

; Goto shortcuts (g prefix)
goto_docs=^k
goto_desktop=^{Backspace}
goto_root=+{Backspace}
goto_home=+{Tab}%homepath%{Enter}

; ============================================================================
; WINDOWS FILE EXPLORER
; ============================================================================

[App_Explorer]
Enabled=true
WindowClass=CabinetWClass
WindowTitle=

; Navigation
nav_left={Backspace}
nav_down={Down}
nav_up={Up}
nav_right={Enter}

; Extended Navigation
nav_page_up={PgUp}
nav_page_down={PgDn}
nav_doc_start={Home}
nav_doc_end={End}

; History
nav_history_back=!{Left}
nav_history_forward=!{Right}

; Actions
action_search={F3}
action_rename={F2}
action_delete={Delete}
action_properties=!{Enter}
action_new_folder=^+n

; Selection
select_all=^a

; View
view_refresh={F5}
view_details=^+6
view_icons=^+2

; ============================================================================
; MICROSOFT EXCEL
; ============================================================================

[App_Excel]
Enabled=true
WindowClass=XLMAIN
ControlPattern=EXCEL7

; Navigation
nav_left={Left}
nav_down={Down}
nav_up={Up}
nav_right={Right}

; Extended Navigation
nav_word_left=^{Left}
nav_word_right=^{Right}
nav_line_start=^{Left}
nav_line_end=^{Right}

; Page Navigation
nav_page_up={PgUp}
nav_page_down={PgDn}

; Actions
action_edit={F2}
action_delete={Delete}
action_undo=^z
action_redo=^y

; Row/Column operations
delete_row=+{Space}{AppsKey}d
select_row=+{Space}
select_col=^{Space}

; ============================================================================
; MICROSOFT WORD
; ============================================================================

[App_Word]
Enabled=true
WindowClass=OpusApp

; Navigation
nav_left={Left}
nav_down={Down}
nav_up={Up}
nav_right={Right}

; Word/Line Navigation
nav_word_left=^{Left}
nav_word_right=^{Right}
nav_line_start={Home}
nav_line_end={End}

; Page/Document Navigation
nav_page_up=^{PgUp}
nav_page_down=^{PgDn}
nav_doc_start=^{Home}
nav_doc_end=^{End}

; Actions
action_delete={Delete}
action_delete_word=^{Delete}
action_delete_line=+{End}{Delete}
action_undo=^z
action_redo=^y

; ============================================================================
; GENERAL TEXT EDITORS (Notepad, Notepad++, VSCode, etc.)
; ============================================================================

[App_TextEditor]
Enabled=true
WindowClass=Notepad|Notepad\+\+|Chrome_WidgetWin_1
WindowTitle=

; Standard vim-like navigation
nav_left={Left}
nav_down={Down}
nav_up={Up}
nav_right={Right}

; Word Navigation
nav_word_left=^{Left}
nav_word_right=^{Right}

; Line Navigation
nav_line_start={Home}
nav_line_end={End}

; Page/Document Navigation
nav_page_up={PgUp}
nav_page_down={PgDn}
nav_doc_start=^{Home}
nav_doc_end=^{End}

; Actions
action_delete={Delete}
action_delete_word=^{Delete}
action_undo=^z
action_redo=^y
action_save=^s

; Search
action_search=^f
action_search_next={F3}
action_replace=^h

; ============================================================================
; CUSTOM APPLICATION TEMPLATE
; Copy this section and modify for your application
; ============================================================================

[App_CustomTemplate]
Enabled=false
WindowClass=YourAppClass
WindowTitle=
ControlPattern=

; Add your custom bindings here
; nav_left={Left}
; nav_down={Down}
; nav_up={Up}
; nav_right={Right}
